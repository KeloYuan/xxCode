# 应用工作区功能

## ✅ 已实现功能

### 工作区位置
文件保存在**应用内部存储**的专属工作区：
- **路径**: `context.filesDir/codes/`
- **显示**: "应用工作区"
- **优势**: 
  - ✅ 无需额外权限
  - ✅ 数据安全隔离
  - ✅ 类似VSCode的工作区概念
  - ✅ 集中管理所有代码文件
  - ✅ 可通过"打开"和"保存"功能与外部文件交互

## 🔧 技术实现

### 1. FileManagerService 实现
```typescript
// 初始化工作区
public init(context: common.UIAbilityContext) {
  this.appFilesDir = context.filesDir;
  this.workspaceDir = `${this.appFilesDir}/codes`;
  
  // 创建工作区目录
  if (!fileIo.accessSync(this.workspaceDir)) {
    fileIo.mkdirSync(this.workspaceDir);
  }
}
```

### 2. 文件浏览器显示
- 标题栏显示 "应用工作区"
- 列出所有工作区内的文件
- 支持创建、打开、删除文件

## 📱 用户体验

### 文件访问
1. **应用内**: 通过文件浏览器管理工作区文件
2. **外部文件**: 通过"打开"按钮选择系统文件
3. **保存外部**: 通过"保存"按钮保存到系统任意位置

### 工作流程
```
方式1: 创建文件 → 保存到工作区 → 在应用内管理
方式2: 打开外部文件 → 编辑 → 保存到原位置或工作区
```

### 类似VSCode
- VSCode: 打开文件夹作为工作区
- 元代码: 应用工作区 + 外部文件访问
- 所有文件集中管理，方便组织

## 🎯 优势特点

### 应用工作区
- ✅ 无需额外权限
- ✅ 数据安全隔离
- ✅ 快速访问常用文件
- ✅ 集中管理代码文件
- ✅ 类似电脑的工作区概念

### 外部文件访问
- ✅ 通过FilePicker打开任意文件
- ✅ 保存到系统任意位置
- ✅ 与其他应用共享文件
- ✅ 灵活的文件管理方式

## 📂 文件结构示例

```
应用数据目录/
└── codes/                    # 工作区根目录
    ├── test.js               # JavaScript文件
    ├── hello.py              # Python文件
    ├── demo.ets              # ArkTS文件
    ├── README.md             # Markdown文件
    └── config.json           # JSON配置
```

## 🚀 使用方法

### 创建文件
1. 点击文件浏览器的"+"按钮
2. 输入文件名（如 `test.js`）
3. 文件自动保存到 `下载/元代码/test.js`

### 打开外部文件
1. 点击工具栏"打开"按钮
2. 在系统文件选择器中选择文件
3. 文件在新标签中打开

### 保存到外部
1. 编辑文件后点击"保存"
2. 如果是外部文件，保存到原位置
3. 如果是新文件，弹出保存对话框选择位置

## ✅ 测试清单

- [x] 工作区目录创建成功
- [x] 文件创建和保存
- [x] 文件读取和打开
- [x] 文件删除
- [x] 工作区路径显示
- [x] 外部文件打开（FilePicker）
- [x] 外部文件保存（FilePicker）
- [x] 多标签管理

## 📝 注意事项

1. **无需权限**: 工作区使用应用内部存储，无需额外权限
2. **兼容性**: 支持 HarmonyOS Next（API 12+）
3. **设备**: 手机、平板、2in1设备均支持
4. **备份**: 工作区文件随应用数据备份
5. **卸载**: 卸载应用会删除工作区文件，请提前导出重要文件

## 🎉 总结

"元代码"应用提供了类似VSCode的工作区概念，同时支持通过FilePicker访问外部文件，兼顾了便利性和灵活性！
